# RECOX

This repository contains the R and Matlab codes for the simulations and analyses presented in the paper (subject to further update):

Rui Yang, Gang Li, Zhe Fei, and co-authors (2025). "Inference for High-dimensional Proportional Hazards Model with Mixed-case Partly Interval-Censored Data." *(Further publication details to be added)*

## Requirements

To run the codes in this repository, you will need:

* **R**: For parts of the analysis and simulations.
* **Matlab**: Version R2022a or newer.
* **Knitro**: The nonlinear optimization solver Knitro is required for the Matlab code to run correctly. It is utilized to solve a nonlinear subproblem.
    * Ensure that the Knitro functions `knitro_options` and `knitro_nlp` are present in Matlab's search path.

## Simulation Settings

The simulations involve generating failure times and covariate data under different scenarios to evaluate the proposed methods.

### General Settings for Simulations

Across both simulation studies, the following settings are generally applied:

* **Subjects and Data**: Given $n$ independent subjects, each subject $i = 1, \ldots, n$ is associated with a non-negative random variable $T_i$ representing the true failure time, and a corresponding $p$-dimensional covariate vector $\mathbf{Z}_i$. 
* **Failure Time Generation**: The true failure time $T_i$ is generated from an exponential distribution with rate $\lambda = e^{\beta'\mathbf{Z}_i}$. 
* **Covariates**: The covariates $\mathbf{Z}_i$ are independent and identically distributed (i.i.d.) from a multivariate normal distribution with mean $\mathbf{0}_p$. 
* **True Regression Parameters ($\beta$)**: The true regression parameter $\beta_j$ takes values $-1.2, -0.8, 0.6, 0.9, 1.5$ at indices $j=1, 50, 100, 150, 200$, respectively. For all other components, $\beta_j=0$. 
* **Variable Selection**: LASSO is applied for variable selection during the screening step. The number of non-zero coefficients is set to $\lfloor \frac{n_1}{\log n_1} \rfloor$, where $n_1$ is the sample size at the screening stage. 
* **Replications and Resampling**: Each configuration is run for 100 replications, with $B = 400$ resampling iterations performed within each replication. 
* **Observation Intervals**: The observation intervals $(L_i, R_i]$ for each subject $i$ are simulated to mimic a longitudinal study with 10 equally spaced examination time points throughout the study duration $(0, \tau)$. $\tau$ is chosen to achieve a desired censoring rate. 
* **Visit Attendance**: The probability that a patient attends each scheduled visit is denoted by $q$. This parameter $q$ controls the proportions of censoring types and the lengths of observation intervals (e.g., $q =0.2$ leads to 80% missed visits and wider observation intervals).
* **Observation Time Generation**: Observation times are generated from a uniform distribution on $(0, \tau)$.  The censoring interval $(L_i, R_i]$ for subject $i$ is determined by selecting $L_i$ as the largest examination time point smaller than $T_i$ and $R_i$ as the smallest examination time point greater than $T_i$. [cite: 7, 8]
* **Exact Observations**: Exact observations are generated by randomly selecting records from the set of left- and interval-censored data and then replacing the recorded $L_i$ and $R_i$ with the true failure time $T_i$.

### Simulation 1

* **Study Duration ($\tau$)**: 3 
* **Visit Attendance Probability ($q$)**: 0.5 
* **Number of Covariates ($p$)**: 4500 
* **Sample Size ($n$)**: 1000 
* **Covariate Covariance Structure**: AR(1) for $\mathbf{Z}_i$. 
* **Approximate Censoring Proportions**:
    * Exact observations: 0% 
    * Left-censored observations: 0% 
    * Right-censored observations: 90% 
    * Case II interval-censored observations: 10% 

### Simulation 2

* **Study Duration ($\tau$)**: 3 
* **Visit Attendance Probability ($q$)**: 0.5 
* **Number of Covariates ($p$)**: 1000 
* **Sample Size ($n$)**: 500 
* **Covariate Covariance Structure**: Identity matrix for $\mathbf{Z}_i$. 
* **Approximate Censoring Proportions**:
    * Exact observations: 30% 
    * Left-censored observations: 20% 
    * Right-censored observations: 40% 
    * Case II interval-censored observations: 10% 

## Evaluation Criteria

The performance of the methods is evaluated based on the following criteria:

1.  **Selection Frequency**: The frequencies that the selected models from the dimension reduction step include all the variables in the true model. This criterion measures the method's ability to correctly screen out unimportant variables.
2.  **Coverage Probability**: The sample proportion that the confidence interval contains the true value of $\beta$.
3.  **Type I error ($\alpha$)**: The sample proportion of rejecting $H_0: \beta^*_j = 0, j=1, \ldots, p,$ given that $H_0$ is true.
4.  **Testing Power**: The sample proportion of rejecting $H_0$ given the true value of $\beta$. i.e., the frequency with which the final models include all the variables in the true model (controlled by the significance level 0.05).

## How to Cite (subject to further update)

If you use these codes or methods in your research, please cite the associated paper:

Rui Yang, Jin Zhou, Hua Zhou, Zhe Fei, Gang Li. (2025). "Inference for High-dimensional Proportional Hazards Model with Mixed-Case Partly Interval-Censored Data." *(Journal/Preprint details forthcoming)*
